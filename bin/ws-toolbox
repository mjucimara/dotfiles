#!/usr/bin/env bash
set -euo pipefail

MODE="${1:-}"
CMD="${2:-bash}"

ensure_toolbox() {
  local name="$1"
  if ! toolbox list | awk '{print $1}' | grep -qx "$name"; then
    toolbox create "$name"
  fi
}

case "$MODE" in
  focus)
    swaymsg workspace number 1
    ensure_toolbox toolbox-go
    exec foot -e toolbox enter toolbox-go "$CMD"
    ;;
  support)
    swaymsg workspace number 3
    ensure_toolbox toolbox-python
    exec foot -e toolbox enter toolbox-python "$CMD"
    ;;
  *)
    echo "Uso: ws-toolbox {focus|support} [cmd]" >&2
    exit 1
    ;;
esac
